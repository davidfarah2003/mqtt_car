{"ast":null,"code":"import { ref } from \"vue\";\n\n/**\n * Use the MQTT.js library to communicate with broker through websockets (Not TCP - that's why I used precompiled-mqtt)\n * @returns {{}}\n */\nconst getMqttClient = async () => {\n  const mqtt = require('precompiled-mqtt');\n  const options = {\n    // Clean session\n    clean: true,\n    connectTimeout: 4000\n    // Auth\n    //clientId: 'emqx_test',\n    //username: 'emqx_test',\n    //password: 'emqx_test',\n  };\n\n  //const client  = mqtt.connect('mqtt://broker.emqx.io:1883', options)\n\n  const connect = () => {\n    return new Promise((resolve, reject) => {\n      let client = ref(null);\n      client = ref(mqtt.connect('mqtt://127.0.0.1:9001'));\n      if (client) {\n        resolve('Promise is resolved successfully.');\n      } else {\n        reject('Promise is rejected');\n      }\n    });\n  };\n  connect().then(message => {\n    console.log(message);\n  }).catch(message => {\n    console.log(message);\n  });\n\n  /*    let client = await connect()\n          .then((message) => {console.log(message)})\n          .catch((message) => {console.log(message)})*/\n\n  client.value.on('connect', function () {\n    console.log('Connected');\n    client.value.subscribe('test', function (err) {\n      if (!err) {\n        client.value.publish('test', 'Hello mqtt');\n      }\n    });\n  });\n  client.value.on('message', function (topic, message) {\n    // message is Buffer\n    console.log(message.toString());\n  });\n  return {\n    client\n  };\n};\nexport default getMqttClient;","map":{"version":3,"names":["ref","getMqttClient","mqtt","require","options","clean","connectTimeout","connect","Promise","resolve","reject","client","then","message","console","log","catch","value","on","subscribe","err","publish","topic","toString"],"sources":["/home/davidf/Desktop/SSB/ssb-interface-v2/src/composables/getMqttClient.js"],"sourcesContent":["import {ref} from \"vue\";\n\n/**\n * Use the MQTT.js library to communicate with broker through websockets (Not TCP - that's why I used precompiled-mqtt)\n * @returns {{}}\n */\nconst getMqttClient = async () => {\n    const mqtt = require('precompiled-mqtt')\n\n\n    const options = {\n        // Clean session\n        clean: true,\n        connectTimeout: 4000,\n        // Auth\n        //clientId: 'emqx_test',\n        //username: 'emqx_test',\n        //password: 'emqx_test',\n    };\n\n    //const client  = mqtt.connect('mqtt://broker.emqx.io:1883', options)\n\n\n    const connect = () => {\n        return new Promise((resolve, reject)=> {\n            let client = ref(null);\n            client = ref(mqtt.connect('mqtt://127.0.0.1:9001'))\n\n            if(client) {\n                resolve('Promise is resolved successfully.');\n            } else {\n                reject('Promise is rejected');\n            }\n        })\n    }\n\n    connect()\n        .then((message) => {console.log(message)})\n        .catch((message) => {console.log(message)})\n    \n/*    let client = await connect()\n        .then((message) => {console.log(message)})\n        .catch((message) => {console.log(message)})*/\n\n    client.value.on('connect', function () {\n        console.log('Connected')\n        client.value.subscribe('test', function (err) {\n            if (!err) {\n                client.value.publish('test', 'Hello mqtt')\n            }\n        })\n    });\n\n    client.value.on('message', function (topic, message) {\n        // message is Buffer\n        console.log(message.toString())\n    });\n\n    return {client}\n}\n\nexport default getMqttClient"],"mappings":"AAAA,SAAQA,GAAG,QAAO,KAAK;;AAEvB;AACA;AACA;AACA;AACA,MAAMC,aAAa,GAAG,YAAY;EAC9B,MAAMC,IAAI,GAAGC,OAAO,CAAC,kBAAkB,CAAC;EAGxC,MAAMC,OAAO,GAAG;IACZ;IACAC,KAAK,EAAE,IAAI;IACXC,cAAc,EAAE;IAChB;IACA;IACA;IACA;EACJ,CAAC;;EAED;;EAGA,MAAMC,OAAO,GAAG,MAAM;IAClB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;MACnC,IAAIC,MAAM,GAAGX,GAAG,CAAC,IAAI,CAAC;MACtBW,MAAM,GAAGX,GAAG,CAACE,IAAI,CAACK,OAAO,CAAC,uBAAuB,CAAC,CAAC;MAEnD,IAAGI,MAAM,EAAE;QACPF,OAAO,CAAC,mCAAmC,CAAC;MAChD,CAAC,MAAM;QACHC,MAAM,CAAC,qBAAqB,CAAC;MACjC;IACJ,CAAC,CAAC;EACN,CAAC;EAEDH,OAAO,EAAE,CACJK,IAAI,CAAEC,OAAO,IAAK;IAACC,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;EAAA,CAAC,CAAC,CACzCG,KAAK,CAAEH,OAAO,IAAK;IAACC,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;EAAA,CAAC,CAAC;;EAEnD;AACA;AACA;;EAEIF,MAAM,CAACM,KAAK,CAACC,EAAE,CAAC,SAAS,EAAE,YAAY;IACnCJ,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;IACxBJ,MAAM,CAACM,KAAK,CAACE,SAAS,CAAC,MAAM,EAAE,UAAUC,GAAG,EAAE;MAC1C,IAAI,CAACA,GAAG,EAAE;QACNT,MAAM,CAACM,KAAK,CAACI,OAAO,CAAC,MAAM,EAAE,YAAY,CAAC;MAC9C;IACJ,CAAC,CAAC;EACN,CAAC,CAAC;EAEFV,MAAM,CAACM,KAAK,CAACC,EAAE,CAAC,SAAS,EAAE,UAAUI,KAAK,EAAET,OAAO,EAAE;IACjD;IACAC,OAAO,CAACC,GAAG,CAACF,OAAO,CAACU,QAAQ,EAAE,CAAC;EACnC,CAAC,CAAC;EAEF,OAAO;IAACZ;EAAM,CAAC;AACnB,CAAC;AAED,eAAeV,aAAa"},"metadata":{},"sourceType":"module"}